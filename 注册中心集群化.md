### 注册中心集群化

---

**关于为什么集群会发送数据一致性的问题**：

在RPC框架中，消费端需要与注册中心获取服务列表，而服务提供端需要提交自己的服务列表并且定时发送心跳来确保服务可用性。为了效率服务端和消费端不可能与所有的集群节点进行通信传输数据，而是选择其中一个节点来保持连接。因此如果比如当前有集群节点A,B,C. 选择连接节点A，当节点A把服务列表提交给B，C节点时发送了机器宕机或者网络中断，导致节点B的服务列表数据被更新了，而C的服务列表没有被更新，从而产生了数据不一致的问题。



#### 关于ZooKeaper 注册中心集群学习：





#### RAFT算法

**选举过程：**

​	当一个节点没有收到来自Leader发送的心跳则任务Leader挂了，在随机睡眠一段时间后，如果没有其他的节点想自己发送拉票申请那么就从Follower转变为Candidate，需要注意的是如果其他的Candidate节点发送的拉票申请中的选举期id不大于当前自己的选举期id，那么则认为该拉票无效，不会去投票。 同时将自己当前的选举期id+1，然后向其他节点发送拉票申请。如果在成为Candidate期间收到了Leader发来的确认消息，那么从Candidate恢复到Follower状态。当拉票申请发送给其他节点后，当超过半数的节点返回ACK后，则从Candidate跃身为Leader，然后给其他节点发送确认信息。如果一个集群内没有选取出Leader，那么进入下一轮，继续选举直到有Leader产生。至此，选举过程

**日志复制：**

​	当新的Leader产出后或者客户端发送了一条新的日志信息，那么开始进行日志复制过程。Leader首先将收到的日志添加到自己的日志集合中，然后向其他的Follower节点发送附加日志请求。当超过一半的Follower节点收到日志并返回ACK后，Leader将日志应用，并且通知其他节点进行应用。

**安全性：**

​	

